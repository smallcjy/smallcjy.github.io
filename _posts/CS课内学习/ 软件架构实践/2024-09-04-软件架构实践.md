---
title: 软件架构期末复习
date: 2024-09-04 20:51:07
tags: CS课内学习
---

## 考纲

### The definition, concepts, and types of Module Structure, Allocation Structure, and C&C1.Structure.

#### Module **Structure**
* definition:

![alt text](assets/img/软件架构实践/image.png)

模块结构的基本元素是模块，是实现基本单元。模块表示一种考虑系统代码的方法，被分配功能责任区域。

type：
1. 分解：分解的结果是通过“是一个子模块”关系将彼此关联起来的模块，分解展示如何将较大的模块递归地分解为较小的子模块，直到足够小，可以被理解和实现。
2. 使用：模块、过程和模块接口上的资源，这些单元通过使用关系连接起来，称第一个单元使用第二个单元。模块结非常适合增量式开发，通过添加模块并通过使用关系连接进系统，实现系统的增量式开发。
3. 分层：当以一种特定的方式小地控制该结构的使用关系时，就出现了由层组成的系统。层是相关功能的一致的集合。把下层实现对上层隐藏起来，实现可移植性。
4. 类和泛化：模块结构中的模块具体实现为类。

#### Allocation structure

![alt text](assets/img/软件架构实践/image-2.png)

分类结构：展示软件元素和创建并执行软件的一个或多个外部环境中的元素之间的关系。问答的问题是：每个软件元素在什么处理器上执行？在开发、测试和系统构建期间，每个元素储存在什么文件中？分配给开发小组的软件元素是什么？

type：
* 部署：部署结构展示如何将软件分配给硬件处理和通信元素。元素是软件、硬件实体和通信路径，关系是分配给和移植到。
* 实现：实现结构展示软件元素是如何映射到系统开发、集成或配置控制环境中的文件结构上。
* 工作分配：工作分配结构将实现和集成模块的责任分配给适当的开发小组，可以使关于谁做该工作的决策具有管理上的和架构上的两层含义变得很清晰。

#### C&C Structure

![alt text](assets/img/软件架构实践/image-1.png)

该结构内的基本元素为运行时组件和连接器。该结构可以回答什么是主要执行组件、如何交互、共享数据存储、哪里可以并行运行。

type：
* 进程或通信进程：处理运行系统的动态方面，通过通信、同步和/或排除操作彼此相连的进程是基本单元。
* 并发：单元是组件、连接器是逻辑线程。逻辑线程是一系列的计算，可以将这些计算分配给不同的物理线程单独运行，从而不阻塞当前线程。
* 共享数据或存储库：该结构由创建、储存和访问持久数据的组件和连接器组成。展示软件元素如何产生和使用数据，可以使用该结构确保良好的性能和数据完整性。
* CS架构：系统被构建为一组彼此协作的客户机和服务器。组件是客户机和服务器，连接器是协议以及共享来执行系统工作的消息。

总结：

![alt text](assets/img/软件架构实践/image-3.png)

* 问题：
  * Seven categories of design decisions?

  * lts role in project risk reduction? (how to reduce risks?).
  
### The types, concepts, and tactics of OAs.
#### type 
一共有3类质量属性：系统的质量属性、受架构影响的商业属性、与架构本身相关的一些质量属性

重点讨论系统的质量属性：可用性、可修改性、性能、安全性、可测试性和易用性

#### 1. 可用性 Availability
1. 可用性是指软件具备在需要时准备好执行任务的特性。
2. the ability of a system to mask or repair faults such that the cumulative service oiutage period does not exceed a required value over a specified time interval.
3. is about minimizing service outage time by mitigating faults(减轻故障).

* 关注内容：
  * 如何检测系统故障
  * 系统故障发生的频度
  * 出现故障时会发生什么情况
  * 允许系统有多长事件非正常运行
  * 什么时候可以安全地出现故障
  * 如何防止故障的发生以及发生故障时要求进行那种通知

定义：系统正常运行的时间比例

![alt text](assets/img/软件架构实践/image-4.png)

**可用性的一般场景：**
* 刺激源：刺激源分为外部和内部、对应刺激源的响应是不同的。
* 刺激：可能会发生的错误
  * 疏忽
  * 崩溃
  * 时间
  * 响应
* 制品：指定了要求具有极高可用性的资源：处理器、通信通道、进程或储存
* 环境：当出现错误、故障时，系统的状态会影响期望的系统响应。
* 响应：在出现系统故障时，对错误进行捕捉处理
* 响应量度：系统必须可用的时间间隔

**Availability Tactics 可用性策略**
* **Goal：**
  * Availability Tactics enable a system to endure faults so that services remain compliant with their specifications.
  * The tactics keep faults from becoming failures or at least bound the effects of the fault and make repair possible.
* **Tactics Tree:**
可用性的策略树有五个分支：输入错误、检测故障、从故障中恢复、防范故障、输出结果。
  * 输入错误
  * Detect Faults：Ping&Echo, Monitor, Heartbeat, Timestamp, Sanity Checking 完整性检查, Condition Monitoring, Voting, Exception Detection, Self-Test
  * Recover from Faults：
    * Preparation, Reintroduction and Repair: Active Redundancy, Passive Redundancy, Spare, Exception Handling, Rollabck, Software Update, Retry, Ignore Faulty Behavior, Degradation, Reconfiguration
    * Reintroduction: Shadow, State Resynchronization, Escalating Restart, Non-Stop Forwarding
  * Prevent Faults: Removal from Service, Transactions, Predictive Model, Exception Prevention, Incrase Competence Set
  * Output: Fault Masked or Repair made
  
**Detect Faults: 故障检测**
* **Ping&Echo:** 检查网络可达性以及测量通过相关网络路径的往返延迟。
* **Monitor:** 监控组件用于检测系统的其他部分的健康状态
* **Heartbeat:** 系统监控器与被监控进程之间的周期性消息交换
* **Timestamp:** detect incorrect sequences of events, particularly in distributed message-passing systems
* **Condition Monitoring:** The process of checking the conditions of a device or process, or validating assumption make during design
* **Checksum:** used in data storage and transmission to ensure the integrity of the data
* **voting:** the common realization of this tactic is Triple Modular Redundancy (TMR) 

**Recover from Faults(Preparation & Repair)**

* Active Redundancy:
* Spare
* Warm Spare
* Rollback
* Retry
* Ingnore Faulty Behavior 鸵鸟算法
* Degradation: 保持最关键的系统功能，同时丢弃较不重要的功能

**Prevent Faults**

* Removal from Service
* Transactiosn 事务：Transaction bundle state updates to ensure that asyncchronous messages exchanged between distributed components are 
  * Atomic: 原子的
  * Consistent 事务中不会使得系统出现不一致的状态
  * Isolated 事务之间是隔离的
  * Durable 事务是持久的
* Predictive Model: 预测模型在检测到可能导致未来出现故障的条件时，采取纠正措施
* Increase Competence Set

#### 2. 可修改性 Modifiability

##### concept
Modifiablity is about change and our interest in it is in the cost and risk of making changes. 

* 关注内容
  * 可以修改什么
  * what is the likelihood of the change
  * 何时进行变更以及由谁进行变更
  * what is the cost of the change

**可修改性的一般场景:**
* 刺激源：规定由谁来进行改变（开发人员、系统管理员、最终用户）
* 刺激：这部分指定了要进行的改变：增删改功能、优化系统质量、提高可用性
* 制品：指定要对什么进行改变：系统的功能、平台、用户界面、环境或者与之操作的另一个系统
* 环境：指定了什么时候可以进行改变（设计、编译、构建、启动、运行）
* 响应：理解如何改变、然后进行改变、测试和部署。
* 响应度量：根据所影响的元素的数量度量的成本、努力、资金；该修改对其他功能或质量属性所造成的影响的程度。

##### tactics
**Goal**

* controlling the complexity of making changes
* controlling the time and cost to make changes

**Tactics Tree(必考)**

![tactics tree](assets/img/2024-09-04-软件架构实践/image.png)

**Reduce Size of a Module**

• Split Module: If the module being modified includes a great deal of capability, the modification costs will likely be high. 
• 拆分模块：如果被修改的模块包含大量功能，则修改成本可能会很高。
• Refining the module into several smaller modules should reduce the average cost of future changes.
• 将模块细化为几个较小的模块应该可以降低未来更改的平均成本。

**Increase Cohension**

模块中的职责A和职责B不为同一个目的而服务，那么他们应该被划分到不同的模块。

**Reduce Coupling**

* What is coupling: A model's dependence of other models.
* If two modules's responsibilities overlap, a single change may affect them both.
* Coupling i smaasured by this overlap(重叠)(即对一个模块的修改会传播到另一个模块的概率)
* High coupling is an enemy of modifiability.

措施：
1. Encapsulate：封装，通过隐藏模块的内部细节，可以减少模块之间的耦合。
2. Intermediary：中间件，打破模块之间的直接联系，通过引入一个中间件，可以减少模块之间的耦合。
3. Restrict Dependencies：限制依赖
4. Abstract Common Services：抽象公共服务，通过提供一个抽象的接口，可以减少模块之间的耦合。常见于cpp中的虚父类声明公共服务接口，rust中的trait也有相同的作用。

几个常见的异步模型：

**Pub-Sub Mode**

![alt text](assets/img/2024-09-04-软件架构实践/image-1.png)

**P2P Mode**

![alt text](assets/img/2024-09-04-软件架构实践/image-2.png)

**Key Functions Implemented by P/S Middleware Service**
* Event Filtering ：据特定的条件或规则筛选事件，以便只将感兴趣的事件传递给订阅者

其实就是将发送给publisher的事件进行分类，订阅者在订阅时选择关心的事件类别，publisher在监听到事件到来的时就会先判断事件类别，然后选择性的调用notify。可以按主题分类Topic-based，也可以按内容分类Content-based。

优点：
- Highly suited for mobile applications, ubiquitous computing, and distributed embedded systems. / 非常适合用于移动应用、普适计算和分布式嵌入式系统。
- Robust - Failure of publishers or subscribers does not bring down the entire system. / 强健性 - 发布者或订阅者的失败不会导致整个系统崩溃。
- Scalability - Suited to build distributed applications consisting of a large number of entities. / 可扩展性 - 适用于构建由大量实体组成的分布式应用。
- Adaptability - Can be varied to suit different environments (mobile, internet games, embedded systems, etc.). / 适应性 - 可以根据不同的环境（如移动、互联网游戏、嵌入式系统等）进行调整。

缺点：
- Reliability - No strong guarantee on broker to deliver content to subscriber. After a publisher publishes the event, it assumes that all corresponding subscribers will receive it. / 可靠性 - 经纪人无法强有力地保证将内容传递给订阅者。在发布者发布事件后，它假设所有相关订阅者都会接收到事件。
- Potential bottleneck in brokers when subscribers and publishers overload them. (Solve by load balancing techniques) / 当订阅者和发布者过载时，经纪人可能成为潜在的瓶颈。（通过负载均衡技术解决）


* Event Routing: 事件路由，将事件传递给订阅者

#### 3. 性能 Performance
##### concept
性能与时间有关，事件发生时，系统必须对其做出响应。性能与将要耗费系统多长时间做出响应有关。

**性能的一般场景：**
* 刺激源：来自外部或内部。
* 刺激：事件的到来。
* 制品：系统的服务。
* 环境：正常模式、超载模式
* 响应：处理刺激：改变服务级别
* 响应度量：系统处理到达事件所用的时间（等待时间或必须处理的事件的期限）、该时间的变化（抖动）、在某一特定时间间隔内可以处理的事件数量（吞吐量）或对不能处理的事件的描述。（缺失值、数据丢失）

##### tactics
**Goal**
- to generate a response to an event arriving at the system within some time-based constraint.
- The event can be single or a stream, and is the trigger to perform computation

**Categories / 类别**

Control resource demand / 控制资源需求 
- To produce smaller demand on the resources / 产生对资源的较小需求
- Operate on the demand side / 在需求侧操作
Manage resources / 管理资源 
- To make the resources at hand work more effectively in handling the demands / 使手头的资源在处理需求时更有效地工作
- Operate on the response side / 在响应侧操作

Resources / 资源
- Hardware resources / 硬件资源: e.g., CPU, data stores, network bandwidth, and memory.
 硬件资源：例如 CPU、数据存储、网络带宽和内存。
- Software resources / 软件资源: e.g., buffers, or critical sections.
 软件资源：例如缓冲区或关键区段（critical sections）。


**Tatics Tree(开源节流)**
* **节流 控制资源需求**

![alt text](assets/img/2024-09-04-软件架构实践/image-3.png)

**Manage Sample Rate**
* Objective: To reduce the sampling frequency at which stream of data is captured, helping to minimize unnecessary data processing and system load

减少对捕捉到的数据流的采样频率，有助于减少不必要的数据处理和系统负载

**Prioritize Events**

* **开源 管理资源**

![alt text](assets/img/2024-09-04-软件架构实践/image-4.png)

#### 4. 安全性 Security
安全性是衡量系统在向合法用户提供服务的同时，阻止非授权使用的能力。

**安全性的一般场景：**
* 刺激源：攻击源是人或者另一个系统。
* 刺激：攻击或试图违反安全性。
* 制品：攻击的目标可能是系统提供的服务、也可能是系统中的数据。
* 环境：在线或离线；联网或断网；有防火墙或没有防火墙
* 响应：对用户进行身份验证、隐藏用户的身份；阻止对数据和服务的访问；
* 响应度量：用成功的概率表示、避开安全防御措施所需要的时间、努力、资源；检测攻击的可能性；

#### 5. 可测试性 Testability
通过测试揭示软件缺陷的容易程度。

**可测试性的一般场景：**
* 刺激源：单元开发人员、增量集成人员、系统验证人员、客户验收人员、系统用户
* 刺激：已完成的分析、架构、设计、类和子系统集成；所交付的系统
* 制品：设计、代码段、完成的应用
* 环境：设计时、开发时、编译时、部署时
* 响应：提供对状态值的访问、提供所计算的值、准备测试环境
* 响应度量：一致性的可执行语句的百分比、如果存在缺陷出现故障的概率、测试用例的数量、测试用例的覆盖率

#### 6. 易用性 Usability

易用性关注的是对用户来说完成某个期望任务的容易程度和系统所提供的用户支持的种类。

**易用性的一般场景：**
* 刺激源：最终用户
* 刺激：最终用户想有效地使用系统，学习使用系统、把错误的影响减到最小，适配系统或对最低的一个示例。
* 制品：系统
* 环境：易用性所涉及的用户从是在运行时或系统配置时发生。
* 响应：系统应该为用户提供所需要的特性，或预计到用户的需要。
* 响应度量：用户学习系统所需的时间、用户在使用系统时所需的时间、用户在使用系统时所需的努力、用户在使用系统时所需的资源。


* 问题：
  * Availability and related tactics (e.g., how to detect faults?)
  * Performance and related tactics

### Architectural Pattern
* 问题：
  * P2P's definition, basic concepts, related QAs (e.g., availability and performance). weaknesses (how to improve?), strengths, and trade-offs.
  * mMapReduce 同上
  * Pipe-and-Filter 同上

### ATAM (architectural reasons), Participants' Roles, the usage of Utility Tree

### Open discussion.
* 例子：
  * The abstract common services tactic is intended to reduce coupling, but it alsomight reduce cohesion? 
  * Discuss the choice of programming language `(`an example of choice of technology`)` and its relation to architecture in general

### TestBook p409